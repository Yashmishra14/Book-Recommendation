<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BookWorld - Top Books Collection</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/components.css') }}">
    <script src="{{ url_for('static', filename='js/main.js') }}" defer></script>
</head>
<body class="second-page">
    <!-- Background Animation -->
    <div class="second-bg-animation"></div>
    
    <!-- Floating geometric shapes -->
    <div class="second-geometric-shapes">
        <div class="second-shape"></div>
        <div class="second-shape"></div>
        <div class="second-shape"></div>
        <div class="second-shape"></div>
    </div>

    <!-- Navigation -->
    <nav class="second-navbar">
        <div class="second-nav-container">
            <a href="/second" class="second-logo">
                <i class="fas fa-book-open"></i>
                BookWorld
            </a>
            <ul class="second-nav-links">
                <li><a href="/second">Home</a></li>
                <li><a href="/recommend">Recommendations</a></li>
                <li><a href="/about">About Us</a></li>
                <li><a href="/dev">Developer</a></li>
            </ul>
            <button class="second-theme-toggle" id="themeToggle">
                <i class="fas fa-moon"></i>
                Dark Mode
            </button>
        </div>
    </nav>

    <!-- Main content -->
    <main class="second-main-content">
        <div class="second-page-header">
            <h1 class="second-page-title">Top 50 Books</h1>
            <p class="second-page-subtitle">Discover the most popular and highly-rated books</p>
        </div>

        <div class="second-books-container">
            <div class="books-grid">
                {% for i in range(book_name|length) %}
                <div class="book-card" data-book="{{ book_name[i] }}">
                    <img src="{{image[i]}}" alt="{{ book_name[i] }}" class="book-image" 
                         onerror="this.src='https://via.placeholder.com/300x400/667eea/ffffff?text=Book+Cover'">
                    <div class="book-info">
                        <h3 class="book-title">{{ book_name[i] }}</h3>
                        <p class="book-author">{{ author[i] }}</p>
                        <div class="book-stats">
                            <div class="book-rating">
                                <span class="rating-stars">
                                    {% for star in range(5) %}
                                        {% if star < rating[i]|int %}
                                            <i class="fas fa-star"></i>
                                        {% else %}
                                            <i class="far fa-star"></i>
                                        {% endif %}
                                    {% endfor %}
                                </span>
                                <span>{{ "%.1f"|format(rating[i]) }}</span>
                            </div>
                            <div class="book-votes">{{ votes[i] }} votes</div>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </main>
    
        <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.4.4/dist/umd/popper.min.js"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
        
    <script>
        // Theme toggle functionality with localStorage persistence
        const themeToggle = document.getElementById('themeToggle');
        const body = document.body;
        let isDark = localStorage.getItem('theme') === 'dark';

        // Apply saved theme on page load
        if (isDark) {
            body.classList.add('dark-theme');
            updateThemeToggle(true);
        }

        function updateThemeToggle(darkMode) {
            if (darkMode) {
                themeToggle.innerHTML = '<i class="fas fa-sun"></i> Light Mode';
            } else {
                themeToggle.innerHTML = '<i class="fas fa-moon"></i> Dark Mode';
            }
        }

        themeToggle.addEventListener('click', function() {
            isDark = !isDark;
            body.classList.toggle('dark-theme');
            localStorage.setItem('theme', isDark ? 'dark' : 'light');
            updateThemeToggle(isDark);
        });

        // Enhanced book card interactions
        document.querySelectorAll('.book-card').forEach((card, index) => {
            // Add staggered entrance animation
            card.style.opacity = '0';
            card.style.transform = 'translateY(30px)';
            card.style.transition = `all 0.6s ease ${index * 0.1}s`;
            
            // Trigger animation after a short delay
            setTimeout(() => {
                card.style.opacity = '1';
                card.style.transform = 'translateY(0)';
            }, 100 + (index * 100));

            // Enhanced hover effects
            card.addEventListener('mouseenter', function() {
                this.style.transform = 'translateY(-15px) scale(1.03)';
                this.style.zIndex = '10';
            });
            
            card.addEventListener('mouseleave', function() {
                this.style.transform = 'translateY(0) scale(1)';
                this.style.zIndex = '1';
            });

            // Click animation with ripple effect
            card.addEventListener('click', function(e) {
                // Create ripple effect
                const ripple = document.createElement('div');
                const rect = this.getBoundingClientRect();
                const size = Math.max(rect.width, rect.height);
                const x = e.clientX - rect.left - size / 2;
                const y = e.clientY - rect.top - size / 2;
                
                ripple.style.cssText = `
                    position: absolute;
                    width: ${size}px;
                    height: ${size}px;
                    left: ${x}px;
                    top: ${y}px;
                    background: ${isDark ? 'rgba(255, 255, 255, 0.2)' : 'rgba(102, 126, 234, 0.3)'};
                    border-radius: 50%;
                    transform: scale(0);
                    animation: ripple 0.6s linear;
                    pointer-events: none;
                    z-index: 15;
                `;
                
                this.appendChild(ripple);
                
                setTimeout(() => {
                    ripple.remove();
                }, 600);

                // Add a subtle bounce effect
                this.style.transform = 'translateY(-15px) scale(1.05)';
                setTimeout(() => {
                    this.style.transform = 'translateY(-15px) scale(1.03)';
                }, 150);
            });

            // Add keyboard navigation
            card.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    this.click();
                }
            });

            // Make cards focusable
            card.setAttribute('tabindex', '0');
        });

        // Add CSS for ripple animation
        const style = document.createElement('style');
        style.textContent = `
            @keyframes ripple {
                to {
                    transform: scale(4);
                    opacity: 0;
                }
            }
            
            .book-card:focus {
                outline: 2px solid var(--primary-color);
                outline-offset: 2px;
            }
            
            .book-card:focus-visible {
                outline: 2px solid var(--primary-color);
                outline-offset: 2px;
            }
        `;
        document.head.appendChild(style);

        // Smooth scroll for navigation
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        // Add scroll-based navbar effect
        let lastScrollY = window.scrollY;
        const navbar = document.querySelector('.second-navbar');

        window.addEventListener('scroll', () => {
            const currentScrollY = window.scrollY;
            
            if (currentScrollY > 100) {
                navbar.style.background = isDark ? 'rgba(0, 0, 0, 0.9)' : 'rgba(255, 255, 255, 0.95)';
                navbar.style.backdropFilter = 'blur(20px)';
                navbar.style.boxShadow = '0 4px 20px rgba(0, 0, 0, 0.1)';
            } else {
                navbar.style.background = isDark ? 'rgba(0, 0, 0, 0.8)' : 'rgba(255, 255, 255, 0.1)';
                navbar.style.backdropFilter = 'blur(20px)';
                navbar.style.boxShadow = 'none';
            }
            
            lastScrollY = currentScrollY;
        });

        // Add loading state with fade in
        window.addEventListener('load', function() {
            document.body.style.opacity = '0';
            document.body.style.transition = 'opacity 0.8s ease';
            
            setTimeout(() => {
                document.body.style.opacity = '1';
            }, 200);
        });

        // Add search functionality (if needed)
        function filterBooks(searchTerm) {
            const cards = document.querySelectorAll('.book-card');
            cards.forEach(card => {
                const title = card.querySelector('.book-title').textContent.toLowerCase();
                const author = card.querySelector('.book-author').textContent.toLowerCase();
                const search = searchTerm.toLowerCase();
                
                if (title.includes(search) || author.includes(search)) {
                    card.style.display = 'block';
                    card.style.animation = 'fadeInUp 0.5s ease';
                } else {
                    card.style.display = 'none';
                }
            });
        }

        // Add keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            // Toggle theme with Ctrl/Cmd + D
            if ((e.ctrlKey || e.metaKey) && e.key === 'd') {
                e.preventDefault();
                themeToggle.click();
            }
            
            // Focus search with Ctrl/Cmd + K
            if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
                e.preventDefault();
                // Add search functionality here if needed
                console.log('Search shortcut triggered');
            }
        });

        // Add performance optimization
        let ticking = false;
        function updateOnScroll() {
            // Throttle scroll events for better performance
            if (!ticking) {
                requestAnimationFrame(() => {
                    // Scroll-based animations can be added here
                    ticking = false;
                });
                ticking = true;
            }
        }

        window.addEventListener('scroll', updateOnScroll);
    </script>
</body>
</html>
